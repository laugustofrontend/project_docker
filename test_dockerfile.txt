FROM ubuntu:16.04

MAINTAINER Lucas<lucas.augusto5061@gmail.com>

ENV DEBIAN_FRONTEND noninteractive

# Install basics
RUN apt-get update && apt-get upgrade -y
RUN apt-get install -y software-properties-common
RUN echo "deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main \ndeb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main" | tee /etc/apt/sources.list.d/ondrej.list
RUN apt-get update
RUN add-apt-repository ppa:ondrej/php
RUN apt-get update
RUN apt-get install -y - force-yes curl

# Install PHP 5.6
RUN apt-get install -y - allow-unauthenticated php5.6 php5.6-mysql php-5.6-mcrypt php5.6-cli php5.6-gd php5.6-curl php5.6-mbstring php5.6-dev php5.6-zip php5.6-intl php.5.6-gettext

# Enable apache mods
RUN a2enmod php5.6
RUN a2enmod rewrite

# Update the php.ini file, enable <??> tags and quieten logging.

RUN sed -i "s/short_open_tag = Off/short_open_tag = On" /etc/php/5.6/apache2/php.ini

# Manually set up the apache enviroment variables
ENV APACHE_LOCK_DIR="/var/lock"
ENV APACHE_PID_FILE="/var/run/apache2.pid"
ENV APACHE_RUN_USER="www-data"
ENV APACHE_RUN_GROUP="www-data"
ENV APACHE_LOG_DIR="/var/log/apache2"

# Expose apache
EXPOSE 80
EXPOSE 8080
EXPOSE 443
EXPOSE 3306

# Update the default apache site with the config we created.
ADD apache-config.conf /etc/apache2/sites-enabled/000-default.conf

# By default start up apache in the foreground, override with /bin/bash for interative.

CMD /usr/sbin/apache2ctl -D FOREGROUND